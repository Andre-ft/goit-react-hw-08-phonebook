(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{113:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),r=n(37),s=n.n(r),o=(n(76),n(5)),i=n(6),u=n(21),l=n(1),b={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},d=function(){return Object(l.jsxs)("nav",{children:[Object(l.jsx)(u.b,{to:"/",exact:!0,style:b.link,activeStyle:b.activeLink,children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}),Object(l.jsx)(u.b,{to:"/contacts",exact:!0,style:b.link,activeStyle:b.activeLink,children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"})]})},j=n(25),f=n(18),h=n.n(f),O=n(19),m=n.n(O),p=n(2);m.a.defaults.baseURL="https://connections-api.herokuapp.com";var x,g=function(t){m.a.defaults.headers.common.Authorization="Bearer ".concat(t)},v=function(){m.a.defaults.headers.common.Authorization=""},y=Object(p.c)("auth/register",function(){var t=Object(j.a)(h.a.mark((function t(e){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.post("/users/signup",e);case 3:return n=t.sent,a=n.data,g(a.token),t.abrupt("return",a);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),C=Object(p.c)("auth/login",function(){var t=Object(j.a)(h.a.mark((function t(e){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.post("/users/login",e);case 3:return n=t.sent,a=n.data,g(a.token),t.abrupt("return",a);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),k=Object(p.c)("auth/logout",Object(j.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.post("/users/logout");case 3:v(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))),w=Object(p.c)("auth/refresh",function(){var t=Object(j.a)(h.a.mark((function t(e,n){var a,c,r,s;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.getState(),null!==(c=a.auth.token)){t.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442, \u0443\u0445\u043e\u0434\u0438\u043c \u0438\u0437 fetchCurrentUser"),t.abrupt("return",n.rejectWithValue());case 5:return g(c),t.prev=6,t.next=9,m.a.get("/users/current");case 9:return r=t.sent,s=r.data,console.log("data",s),t.abrupt("return",s);case 15:t.prev=15,t.t0=t.catch(6);case 17:case"end":return t.stop()}}),t,null,[[6,15]])})));return function(e,n){return t.apply(this,arguments)}}()),_={register:y,logOut:k,logIn:C,fetchCurrentUser:w},L={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUsername:function(t){return t.auth.user.name}},S=n(10),F=Object(p.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(x={},Object(S.a)(x,_.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(S.a)(x,_.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(S.a)(x,_.logOut.fulfilled,(function(t,e){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(S.a)(x,_.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0})),x)}).reducer,I=n.p+"static/media/default-avatar.e44fc4e2.png",N={container:{display:"flex",alignItems:"center"},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function A(){var t=Object(o.d)(),e=Object(o.e)(L.getUsername),n=I;return Object(l.jsxs)("div",{style:N.container,children:[Object(l.jsx)("img",{src:n,alt:"",width:"32",style:N.avatar}),Object(l.jsxs)("span",{style:N.name,children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c, ",e]}),Object(l.jsx)("button",{type:"button",onClick:function(){return t(_.logOut())},children:"\u0412\u044b\u0439\u0442\u0438"})]})}var B={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}};function z(){return Object(l.jsxs)("div",{children:[Object(l.jsx)(u.b,{to:"/register",exact:!0,style:B.link,activeStyle:B.activeLink,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(l.jsx)(u.b,{to:"/login",exact:!0,style:B.link,activeStyle:B.activeLink,children:"\u041b\u043e\u0433\u0438\u043d"})]})}var q={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}};function D(){var t=Object(o.e)(L.getIsLoggedIn);return Object(l.jsxs)("header",{style:q.header,children:[Object(l.jsx)(d,{}),t?Object(l.jsx)(A,{}):Object(l.jsx)(z,{})]})}var E,T=n(30),U=n(62),R=n.n(U),M=n(63),P=n(12),W=Object(M.a)({reducerPath:"contactApi",baseQuery:Object(P.d)({baseUrl:"https://61fe5bafa58a4e00173c97fc.mockapi.io/api/v1/"}),tagTypes:["Contact"],endpoints:function(t){return{fetchContacts:t.query({query:function(){return"/contacts"},providesTags:["Contact"]}),deleteContact:t.mutation({query:function(t){return{url:"/contacts/".concat(t),method:"DELETE"}},invalidatesTags:["Contact"]}),createContact:t.mutation({query:function(t){return{url:"/contacts",method:"POST",body:{name:t.name,number:t.number}}},invalidatesTags:["Contact"]})}}}),V=W.useFetchContactsQuery,J=W.useDeleteContactMutation,Z=W.useCreateContactMutation,H=n(9),Q=n(48),G=n.n(Q),K=n(64),$=n(71),X=n(45),Y=n(70),tt=Object(X.a)(E||(E=Object(K.a)(["\n0% {\n  transform: rotate(0deg);\n}\n100% {\n  transform: rotate(1turn);\n}\n"]))),et=Object($.a)(Y.a,{target:"e19vvtzt0"})("animation:",tt," 0.85s linear infinite;");et.defaultProps={size:40};var nt=function(t){var e=t.id,n=t.name,a=t.number,c=J(),r=Object(H.a)(c,2),s=r[0],o=r[1].isLoading;return Object(l.jsxs)("li",{className:G.a.contactList__item,children:[n," : ",a,Object(l.jsxs)("button",{type:"button",className:G.a.deleteButton,onClick:function(){return s(e)},disabled:o,children:[o&&Object(l.jsx)(et,{size:12}),"Delete"]})]})},at=Object(a.createContext)();function ct(){var t=Object(a.useContext)(at).filter,e=V(),n=e.data;e.isFetching;return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("ul",{className:R.a.contactList__item,children:n&&function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))}(n,t).map((function(t){return Object(l.jsx)(nt,Object(T.a)({},t),t.id)}))})})}var rt=n(32),st=n.n(rt),ot=n(33),it=n.n(ot),ut=Object(p.b)("contacts/add",(function(t){var e=t.name,n=t.number;return{payload:{id:st.a.generate(),name:e,number:n}}})),lt=Object(p.b)("contacts/delete"),bt=Object(p.b)("contacts/changeFilter"),dt=Object(p.b)("contacts/fetchContactsSuccess"),jt=Object(p.b)("contacts/fetchContactsRequest"),ft=Object(p.b)("contacts/fetchContactsError"),ht=Object(p.b)("contacts/addContactRequest"),Ot=Object(p.b)("contacts/addContactSuccess"),mt=Object(p.b)("contacts/addContactError"),pt=Object(p.b)("contacts/deleteContactRequest"),xt=Object(p.b)("contacts/deleteContactSuccess"),gt=Object(p.b)("contacts/deleteContactError"),vt=n(49);function yt(){var t=Object(a.useState)(""),e=Object(H.a)(t,2),n=e[0],c=e[1],r=Object(a.useState)(""),s=Object(H.a)(r,2),o=s[0],i=s[1],u=Object(a.useState)(!0),b=Object(H.a)(u,2),d=b[0],j=b[1],f=V(),h=f.data,O=(f.isFetching,Z()),m=Object(H.a)(O,2),p=m[0],x=m[1],g=x.isLoading,v=(x.isSuccess,st.a.generate()),y=st.a.generate(),C=function(t){var e=t.currentTarget,n=e.name,a=e.value;switch("name"===n&&function(t){if(h&&h.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))return j(!1),void alert("".concat(t," is already in contacts"));j(!0)}(a),n){case"name":c(a);break;case"number":i(a)}},k={duration:3e3,position:"top-right",style:{background:"lawngreen"}};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(vt.a,{}),Object(l.jsxs)("form",{className:it.a.form,onSubmit:function(t){t.preventDefault(),Object(vt.b)("Contact added",k),p({name:n,number:o}),c(""),i("")},children:[Object(l.jsxs)("label",{htmlFor:v,className:it.a.input,children:["Name",Object(l.jsx)("input",{type:"text",name:"name",pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan",required:!0,value:n,onChange:C,id:v})]}),Object(l.jsxs)("label",{htmlFor:y,className:it.a.input,children:["Number",Object(l.jsx)("input",{type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"Phone number must be digits and can contain spaces, dashes, parentheses and can start with +",required:!0,value:o,onChange:C,id:y})]}),Object(l.jsxs)("button",{type:"submit",className:it.a.button,disabled:!d||g,children:[g&&Object(l.jsx)(et,{size:12}),"Add contact"]})]})]})}var Ct=n(65),kt=n.n(Ct);function wt(){var t=Object(a.useContext)(at),e=t.filter,n=t.setFilter;return Object(l.jsxs)("label",{className:kt.a.filter,children:["Find contacts by name",Object(l.jsx)("input",{type:"text",value:e,onChange:function(t){return n(t.currentTarget.value)}})]})}var _t,Lt=n(66),St=n.n(Lt),Ft={fetchContacts:function(){return function(){var t=Object(j.a)(h.a.mark((function t(e){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(jt()),t.prev=1,t.next=4,m.a.get("/tasks");case 4:n=t.sent,a=n.data,e(dt(a)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(ft(t.t0.message));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},addContact:function(t){return function(e){var n={description:t,completed:!1};e(ht()),m.a.post("/tasks",n).then((function(t){var n=t.data;return e(Ot(n))})).catch((function(t){return e(mt(t.message))}))}},deleteContact:function(t){return function(e){e(pt()),m.a.delete("/tasks/".concat(t)).then((function(){return e(xt(t))})).catch((function(t){return e(gt(t.message))}))}}},It=Ft,Nt=n(17),At=function(t){return t.contacts.filter},Bt=function(t){return t.contacts.items},zt=(Object(Nt.a)([Bt,At],(function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))})),n(40)),qt=n(7),Dt=Object(p.d)([],(_t={},Object(S.a)(_t,ut,(function(t,e){var n=e.payload;return[].concat(Object(zt.a)(t),[n])})),Object(S.a)(_t,lt,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),_t)),Et=Object(p.d)("",Object(S.a)({},bt,(function(t,e){return e.payload})));Object(qt.b)({items:Dt,filter:Et});function Tt(){var t=Object(o.d)();return Object(a.useEffect)((function(){return t(It.fetchContacts())}),[t]),Object(l.jsxs)("div",{className:St.a.ContactView,children:[Object(l.jsx)("h1",{children:"Phonebook"}),Object(l.jsx)(yt,{}),Object(l.jsx)("h2",{children:"Contacts"}),Object(l.jsx)(wt,{}),Object(l.jsx)(ct,{})]})}var Ut={container:{minHeight:"calc(100vh - 50px)",display:"flex",alignItems:"center",justifyContent:"center"},title:{fontWeight:500,fontSize:48,textAlign:"center"}},Rt=function(){return Object(l.jsx)("div",{style:Ut.container,children:Object(l.jsxs)("h1",{style:Ut.title,children:["\u041f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0430\u0448\u0435\u0433\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430"," ",Object(l.jsx)("span",{role:"img","aria-label":"\u0418\u043a\u043e\u043d\u043a\u0430 \u043f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044f",children:"\ud83d\udc81\u200d\u2640\ufe0f"})]})})},Mt={form:{width:320},label:{display:"flex",flexDirection:"column",marginBottom:15}};function Pt(){var t=Object(o.d)(),e=Object(a.useState)(""),n=Object(H.a)(e,2),c=n[0],r=n[1],s=Object(a.useState)(""),i=Object(H.a)(s,2),u=i[0],b=i[1],d=Object(a.useState)(""),j=Object(H.a)(d,2),f=j[0],h=j[1],O=function(t){var e=t.target,n=e.name,a=e.value;switch(n){case"name":return r(a);case"email":return b(a);case"password":return h(a);default:return}};return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(_.register({name:c,email:u,password:f})),r(""),b(""),h("")},style:Mt.form,autoComplete:"off",children:[Object(l.jsxs)("label",{style:Mt.label,children:["\u0418\u043c\u044f",Object(l.jsx)("input",{type:"text",name:"name",value:c,onChange:O})]}),Object(l.jsxs)("label",{style:Mt.label,children:["\u041f\u043e\u0447\u0442\u0430",Object(l.jsx)("input",{type:"email",name:"email",value:u,onChange:O})]}),Object(l.jsxs)("label",{style:Mt.label,children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(l.jsx)("input",{type:"password",name:"password",value:f,onChange:O})]}),Object(l.jsx)("button",{type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})}var Wt={form:{width:320},label:{display:"flex",flexDirection:"column",marginBottom:15}};function Vt(){var t=Object(o.d)(),e=Object(a.useState)(""),n=Object(H.a)(e,2),c=n[0],r=n[1],s=Object(a.useState)(""),i=Object(H.a)(s,2),u=i[0],b=i[1],d=function(t){var e=t.target,n=e.name,a=e.value;switch(n){case"email":return r(a);case"password":return b(a);default:return}};return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043b\u043e\u0433\u0438\u043d\u0430"}),Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(_.logIn({email:c,password:u})),r(""),b("")},style:Wt.form,autoComplete:"off",children:[Object(l.jsxs)("label",{style:Wt.label,children:["\u041f\u043e\u0447\u0442\u0430",Object(l.jsx)("input",{type:"email",name:"email",value:c,onChange:d})]}),Object(l.jsxs)("label",{style:Wt.label,children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(l.jsx)("input",{type:"password",name:"password",value:u,onChange:d})]}),Object(l.jsx)("button",{type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}var Jt=n(67),Zt=n.n(Jt);function Ht(t){var e=t.children;return Object(l.jsx)("div",{className:Zt.a.container,children:e})}function Qt(){var t=Object(o.d)();return Object(a.useEffect)((function(){t(_.fetchCurrentUser())}),[t]),Object(l.jsxs)(Ht,{children:[Object(l.jsx)(D,{}),Object(l.jsxs)(i.c,{children:[Object(l.jsx)(i.a,{exact:!0,path:"/",component:Rt}),Object(l.jsx)(i.a,{path:"/register",component:Pt}),Object(l.jsx)(i.a,{path:"/login",component:Vt}),Object(l.jsx)(i.a,{path:"/contacts",component:Tt})]})]})}n(110);var Gt=n(22),Kt=n(68),$t=n.n(Kt),Xt=[].concat(Object(zt.a)(Object(p.f)({serializableCheck:{ignoredActions:[Gt.a,Gt.f,Gt.b,Gt.c,Gt.d,Gt.e]}})),[W.middleware]),Yt={key:"auth",storage:$t.a,whitelist:["token"]},te=Object(p.a)({reducer:Object(S.a)({auth:Object(Gt.g)(Yt,F)},W.reducerPath,W.reducer),middleware:Xt,devTools:!1}),ee=Object(Gt.h)(te);function ne(t){var e=t.children,n=Object(a.useState)(""),c=Object(H.a)(n,2),r=c[0],s=c[1],o=Object(a.useMemo)((function(){return{filter:r,setFilter:s}}),[s,r]);return Object(l.jsx)(at.Provider,{value:o,children:e})}var ae=n(69);s.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(ne,{children:Object(l.jsx)(o.a,{store:te,children:Object(l.jsx)(ae.a,{loading:null,persistor:ee,children:Object(l.jsx)(u.a,{children:Object(l.jsx)(Qt,{})})})})})}),document.getElementById("root"))},33:function(t,e,n){t.exports={form:"ContactForm_form__2-q5N",input:"ContactForm_input__1382s",button:"ContactForm_button__OBqyM"}},48:function(t,e,n){t.exports={contactList__item:"ContactListItem_contactList__item__fGcDN",deleteButton:"ContactListItem_deleteButton__JUaaW"}},62:function(t,e,n){t.exports={contactList__item:"ContactList_contactList__item__1gMCN",deleteButton:"ContactList_deleteButton__Hv83B"}},65:function(t,e,n){t.exports={filter:"Filter_filter__1FN7R"}},66:function(t,e,n){t.exports={ContactView:"ContactView_ContactView__2-nbT"}},67:function(t,e,n){t.exports={container:"Container_container__3cLWK"}},76:function(t,e,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.1d46ab6b.chunk.js.map